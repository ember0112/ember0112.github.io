<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Channel Engineer ÏóÖÎ¨¥ ÏÑ±Ìñ• ÌÖåÏä§Ìä∏ - ÎÇòÎäî Ïñ¥Îñ§ Ïú†ÌòïÏùºÍπå?</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyDuE2BfjWhHBI5pBT_FoY-_6wbEfovSaKA",
            authDomain: "ch-eng-corevalue.firebaseapp.com",
            projectId: "ch-eng-corevalue",
            storageBucket: "ch-eng-corevalue.firebasestorage.app",
            messagingSenderId: "1038490021200",
            appId: "1:1038490021200:web:6e8249c9e698da3ad35055",
            measurementId: "G-FH0PM752J7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        // Ï†ÑÏó≠ÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎèÑÎ°ù ÏÑ§Ï†ï
        window.firebaseDB = db;
        window.firebaseCollections = { collection, addDoc, getDocs, query, orderBy, limit };
        console.log('üî• Firebase Ï¥àÍ∏∞Ìôî ÏÑ±Í≥µ!');
        console.log('üîó ÌîÑÎ°úÏ†ùÌä∏ ID:', firebaseConfig.projectId);

        // Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
        setTimeout(async () => {
            try {
                const testQuery = query(collection(db, 'leaderboard'), limit(1));
                await getDocs(testQuery);
                console.log('‚úÖ Firebase Firestore Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ!');
            } catch (testError) {
                console.error('‚ùå Firebase Firestore Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ïã§Ìå®:', testError);
                console.error('ÌÖåÏä§Ìä∏ Ïò§Î•ò ÏÉÅÏÑ∏:', testError.code, testError.message);
            }
        }, 1000);
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            color: #333;
            padding-top: 80px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .logo {
            display: block;
            width: 160px;
            height: auto;
            margin: 0 auto 40px auto;
        }


        .test-container {
            background: white;
            border-radius: 20px;
            padding: 70px 50px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .start-screen {
            text-align: center;
            padding: 80px 40px;
            height: 100vh;
            width: 100vw;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            background: linear-gradient(135deg, #6b46ff 0%, #7c4dff 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .start-logo {
            width: 160px;
            height: auto;
            margin-bottom: 40px;
        }

        .start-icons {
            margin: 40px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .start-icons-image {
            width: 320px;
            height: auto;
            max-width: 80vw;
            opacity: 0.9;
        }

        .start-title {
            font-size: 4rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 30px;
            line-height: 1.2;
        }

        .start-description {
            font-size: 1.2rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 40px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
        }

        .start-form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
        }

        .start-form .btn {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 18px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .start-form .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn {
            background: #000000;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #333333;
            transform: translateY(-1px);
        }

        .nickname-input {
            width: 100%;
            max-width: 350px;
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            transition: all 0.3s ease;
        }

        .nickname-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .nickname-input::placeholder {
            color: #999;
        }

        .question-container {
            display: none;
            padding: 0 70px;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            gap: 8px;
        }

        .progress-segment {
            height: 6px;
            flex: 1;
            background: #e0e0e0;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .progress-segment.active {
            background: #000000;
        }

        .question {
            margin-bottom: 30px;
        }

        .question-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .question-number {
            color: #999;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            opacity: 0.6;
        }

        .question-text {
            color: #333;
            margin: 0;
            font-size: 1.4rem;
            line-height: 1.6;
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
            font-weight: 600;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .option:hover {
            border-color: #572DFF;
        }

        .option.selected {
            border-color: #572DFF;
            background: linear-gradient(45deg, rgba(87, 45, 255, 0.1), rgba(118, 75, 162, 0.1));
        }

        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .option-text {
            font-size: 1.1rem;
            color: #333;
            font-weight: 500;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }

        .result-container {
            display: none;
            text-align: center;
            margin: 0 auto;
            max-width: 800px;
            padding: 0 20px;
        }

        .result-type {
            text-align: center;
            margin-bottom: 30px;
            perspective: 1000px;
        }

        .result-type img,
        .result-type video {
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1200 / 1340;
            object-fit: contain;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.1s ease-out, box-shadow 0.3s ease;
            cursor: pointer;
            transform-style: preserve-3d;
        }

        .result-type img:hover,
        .result-type video:hover {
            transform: scale(1.015);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }


        .result-description {
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-description h3 {
            color: #000000;
            margin-bottom: 10px;
            margin-top: 0;
            font-size: 2.6rem;
            font-weight: 700;
        }

        .result-description h4 {
            color: #666666;
            margin-bottom: 20px;
            margin-top: 0;
            font-size: 1.4rem;
            font-weight: 500;
        }

        .result-description p {
            line-height: 1.7;
            margin-bottom: 15px;
            color: #555;
        }


        .download-btn {
            background: transparent;
            color: #6c757d;
            border: 2px solid #6c757d;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .download-btn:hover {
            background: #6c757d;
            color: white;
            transform: translateY(-1px);
        }

        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .button-group .btn,
        .button-group .download-btn {
            margin: 0;
            min-width: 200px;
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 0;
            width: 100%;
        }

        .other-results {
            margin-top: 50px;
            padding-top: 40px;
            border-top: 2px solid #e9ecef;
        }

        .other-results h3 {
            text-align: center;
            color: #495057;
            margin-bottom: 30px;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .other-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 13px;
            margin-bottom: 30px;
        }

        .other-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 120px;
        }

        .other-card:hover {
            border-color: #572DFF;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(87, 45, 255, 0.15);
        }

        .other-card h4 {
            color: #000000;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            margin-top: 0;
        }



        @media (max-width: 768px) {
            body {
                padding-top: 54px;
            }

            .logo {
                width: 120px;
                margin-bottom: 24px;
            }

            .container {
                padding: 15px;
            }
            
            .test-container {
                background: white;
                box-shadow: 0 10px 20px rgba(0,0,0,0.08);
                border-radius: 16px;
                padding: 0;
                margin: 0 15px;
            }
            
            .options {
                gap: 6px;
            }
            
            .option {
                padding: 15px 20px;
            }
            
            .navigation {
                flex-direction: row;
                justify-content: space-between;
                gap: 15px;
            }
            

            .button-group {
                flex-direction: column;
                align-items: center;
            }

            .button-group .btn,
            .button-group .download-btn {
                width: 100%;
                max-width: 300px;
                margin: 5px 0;
                min-width: auto;
            }

            .result-card {
                padding: 25px;
                margin: 15px;
            }

            .other-cards {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .other-card {
                padding: 20px;
            }

            .start-screen {
                padding: 60px 20px;
            }

            .start-logo {
                width: 120px;
                margin-bottom: 30px;
            }

            .start-icons {
                margin: 30px 0;
            }

            .start-icons-image {
                width: 280px;
                max-width: 90vw;
            }

            .start-title {
                font-size: 1.9rem;
            }

            .start-description {
                font-size: 1rem;
                max-width: 300px;
                margin-left: auto;
                margin-right: auto;
                text-align: center;
            }

            .start-form {
                max-width: 280px;
                margin-left: auto;
                margin-right: auto;
            }

            .nickname-input {
                max-width: 280px;
                padding: 16px 20px;
            }

            .question-container {
                padding: 24px 18px;
            }

            .question-number {
                font-size: 1rem;
                margin-bottom: 15px;
            }

            .question-text {
                font-size: 1.2rem;
                max-width: 100%;
            }

            .option-text {
                font-size: 16px;
                line-height: 1.5;
            }

            .result-description {
                padding: 12px;
            }

            .result-description h3 {
                font-size: 2rem;
            }

            .result-description h4 {
                font-size: 1.2rem;
            }

            .result-container {
                max-width: none;
                width: 100%;
                padding: 0 15px;
                margin: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .result-card {
                width: 100%;
                max-width: 100%;
                margin: 0;
                padding: 20px 15px;
            }
        }

        .leaderboard {
            margin-top: 50px;
            padding-top: 40px;
            border-top: 2px solid #e9ecef;
        }

        .leaderboard h3 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #495057;
        }

        .leaderboard-list {
            background: white;
            border-radius: 15px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f1f3f4;
            transition: background-color 0.2s ease;
        }

        .leaderboard-item:last-child {
            border-bottom: none;
        }

        .leaderboard-item:hover {
            background-color: #f8f9fa;
        }

        .leaderboard-nickname {
            font-weight: 600;
            color: #495057;
        }

        .leaderboard-result {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: right;
        }

        .leaderboard-empty {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 30px;
        }
    </style>
</head>
<body>
    <!-- ÏãúÏûë ÌôîÎ©¥ (Ï†ÑÏ≤¥ ÌôîÎ©¥) -->
    <div class="start-screen" id="startScreen">
        <img src="logo.svg" alt="Channel Logo" class="start-logo">
        <h1 class="start-title">Channel Engineer<br>ÏóÖÎ¨¥ ÏÑ±Ìñ• ÌÖåÏä§Ìä∏</h1>
        <div class="start-icons">
            <img src="img-4set.png" alt="4Í∞ú ÏóÖÎ¨¥ ÏÑ±Ìñ• ÏïÑÏù¥ÏΩò" class="start-icons-image">
        </div>
        <p class="start-description">
            ÎãπÏã†Ïùò ÏóÖÎ¨¥ ÏÑ±Ìñ•ÏùÄ Ïñ¥Îñ§ Core ValueÏóê Í∞ÄÍπåÏö¥Í∞ÄÏöî?<br>
            7Í∞úÏùò Í∞ÑÎã®Ìïú ÏßàÎ¨∏ÏùÑ ÌÜµÌï¥ ÏïåÏïÑÎ≥¥ÏÑ∏Ïöî.<br>
            Ï†ïÎãµÏùÄ ÏóÜÏúºÎãà Ìé∏ÏïàÌïòÍ≤å ÏßÅÍ∞êÏ†ÅÏúºÎ°ú ÎãµÎ≥ÄÌï¥Î≥¥ÏÑ∏Ïöî!
        </p>
        <div class="start-form">
            <input type="text" class="nickname-input" id="nicknameInput" placeholder="ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî" maxlength="10">
            <button class="btn" onclick="startTest()">ÏãúÏûëÌïòÍ∏∞</button>
        </div>
    </div>

    <img src="logo.png" alt="Channel Logo" class="logo">
    <div class="container">
        <div class="test-container">

            <!-- ÏßàÎ¨∏ ÌôîÎ©¥ -->
            <div class="question-container" id="questionContainer">
                <div class="progress-bar" id="progressBar">
                    <div class="progress-segment" data-step="1"></div>
                    <div class="progress-segment" data-step="2"></div>
                    <div class="progress-segment" data-step="3"></div>
                    <div class="progress-segment" data-step="4"></div>
                    <div class="progress-segment" data-step="5"></div>
                    <div class="progress-segment" data-step="6"></div>
                    <div class="progress-segment" data-step="7"></div>
                </div>
                
                <div class="question" id="currentQuestion">
                    <!-- ÏßàÎ¨∏Ïù¥ ÎèôÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎê©ÎãàÎã§ -->
                </div>

            </div>

            <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
            <div class="result-container" id="resultContainer">
                <!-- Í≤∞Í≥ºÍ∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <script>
        // ÌÖåÏä§Ìä∏ ÏßàÎ¨∏ Îç∞Ïù¥ÌÑ∞
        const questions = [
            {
                id: 1,
                question: "ÌåÄÏóêÏÑú ÏÉàÎ°úÏö¥ Í∞úÎ∞ú ÎèÑÍµ¨ÎÇò AI ÏΩîÎî© Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏Î•º ÎèÑÏûÖÌïúÎã§Í≥† Î∞úÌëúÌñàÏäµÎãàÎã§. ÎãπÏã†Ïùò Ï≤´ Î∞òÏùëÏùÄ?",
                options: [
                    { text: "Ï¶âÏãú Í∞úÏù∏ ÌîÑÎ°úÏ†ùÌä∏Ïóê Ï†ÅÏö©ÌïòÍ≥† Îπ†Î•¥Í≤å Ïû•Îã®Ï†êÏùÑ ÌååÏïÖÌïòÏó¨ ÌåÄÏóê ÌîºÎìúÎ∞±ÏùÑ Í≥µÏú†ÌïúÎã§", type: "MOVE_FAST" },
                    { text: "Ïù¥ ÎèÑÍµ¨Í∞Ä Í≥†Í∞ùÏóêÍ≤å Îçî ÎÇòÏùÄ ÏÑúÎπÑÏä§Î•º Ï†úÍ≥µÌïòÎäî Îç∞ Ïñ¥ÎñªÍ≤å ÎèÑÏõÄÏù¥ Îê†ÏßÄ Î®ºÏ†Ä ÏÉùÍ∞ÅÌïúÎã§", type: "CUSTOMER_DRIVEN" },
                    { text: "ÎèôÎ£åÎì§Í≥º Í∞ÄÎ≥çÍ≤å ÎåÄÌôîÌïòÎ©∞ Í∞ÅÏûêÏùò Í≤ΩÌóòÍ≥º Ïö∞Î†§ÏÇ¨Ìï≠ÏùÑ Í≥µÏú†ÌïòÍ≥† Ìï®Íªò ÌïôÏäµ Î∞©Ìñ•ÏùÑ ÎÖºÏùòÌïúÎã§", type: "SMALL_TALK" },
                    { text: "ÎèÑÍµ¨Ïùò ÌïµÏã¨ ÏõêÎ¶¨ÏôÄ Ïö∞Î¶¨ Í∏∞Ï°¥ ÏïÑÌÇ§ÌÖçÏ≤òÏôÄÏùò Ìò∏ÌôòÏÑ±ÏùÑ ÍπäÏù¥ Î∂ÑÏÑùÌïú ÌõÑ ÎèÑÏûÖÏùÑ Í≤ÄÌÜ†ÌïúÎã§", type: "DEEP_ROOTS" }
                ]
            },
            {
                id: 2,
                question: "Ï±ÑÎÑêÌÜ° ÏÇ¨Ïö© Í≥†Í∞ùÏúºÎ°úÎ∂ÄÌÑ∞ Í∞ïÌïú ÌÅ¥Î†àÏûÑÏù¥ Îì§Ïñ¥ÏôîÏäµÎãàÎã§. ÎãπÏã†Ïùò ÎåÄÏùë Î∞©ÏãùÏùÄ?",
                options: [
                    { text: "ÌÅ¥Î†àÏûÑÏùò Í∑ºÎ≥∏ ÏõêÏù∏ÏùÑ Î∂ÑÏÑùÌïòÍ≥†, Ïû¨Î∞ú Î∞©ÏßÄÎ•º ÏúÑÌïú Í∑ºÎ≥∏Ï†ÅÏù∏ Ìï¥Í≤∞ Î∞©ÏïàÏùÑ ÏàòÎ¶ΩÌïúÎã§", type: "DEEP_ROOTS" },
                    { text: "Ïö∞ÏÑ† ÏûÑÏãú Ìï¥Í≤∞Ï±ÖÏúºÎ°ú Í≥†Í∞ù Î∂àÌé∏ÏùÑ ÏµúÏÜåÌôîÌïòÍ≥†, Îπ†Î•¥Í≤å ÌÖåÏä§Ìä∏ÏôÄ Í∞úÏÑ†ÏùÑ Î∞òÎ≥µÌïòÏó¨ Ìï¥Í≤∞Ï±ÖÏùÑ ÎèÑÏ∂úÌïúÎã§", type: "MOVE_FAST" },
                    { text: "Í≥†Í∞ùÏùò ÏûÖÏû•ÏóêÏÑú Î¨∏Ï†úÎ•º Ïù¥Ìï¥ÌïòÍ≥†, ÏÇ¨Ïö©Ïûê Í≤ΩÌóòÏóê ÎØ∏ÏπòÎäî ÏòÅÌñ•ÏùÑ ÏµúÏö∞ÏÑ†ÏúºÎ°ú Î∂ÑÏÑùÌïòÏó¨ Ìï¥Í≤∞Ï±ÖÏùÑ Ï∞æÎäîÎã§", type: "CUSTOMER_DRIVEN" },
                    { text: "ÌåÄÏõêÎì§Í≥º Îπ†Î•¥Í≤å ÏÜåÌÜµÌïòÏó¨ ÏÉÅÌô©ÏùÑ Í≥µÏú†ÌïòÍ≥†, Í∞ÅÏûêÏùò Í¥ÄÏ†êÏóêÏÑú Ìï¥Í≤∞Ï±ÖÏùÑ ÎÖºÏùòÌïúÎã§", type: "SMALL_TALK" }
                ]
            },
            {
                id: 3,
                question: "ÏΩîÎìú Î¶¨Î∑∞ÏóêÏÑú ÎèôÎ£åÏôÄ Íµ¨ÌòÑ Î∞©ÏãùÏóê ÎåÄÌïú ÏùòÍ≤¨Ïù¥ Îã§Î•º Îïå ÎãπÏã†Ïùò Î∞òÏùëÏùÄ?",
                options: [
                    { text: "ÏÑúÎ°úÏùò ÏÉùÍ∞ÅÏùÑ Ìé∏ÏïàÌïòÍ≤å ÎÇòÎàÑÎ©∞ Îã§ÏñëÌïú Í¥ÄÏ†êÏùÑ Îì£Í≥†, Ìï®Íªò Îçî ÎÇòÏùÄ ÎåÄÏïàÏùÑ ÌÉêÍµ¨ÌïúÎã§", type: "SMALL_TALK" },
                    { text: "Îëê Î∞©Ïãù Ï§ë Ïñ¥Îñ§ Í≤ÉÏù¥ ÏÇ¨Ïö©ÏûêÏóêÍ≤å Îçî ÎÇòÏùÄ ÏÑ±Îä•Í≥º Í≤ΩÌóòÏùÑ Ï†úÍ≥µÌï†ÏßÄÎ•º Í∏∞Ï§ÄÏúºÎ°ú ÌåêÎã®ÌïúÎã§", type: "CUSTOMER_DRIVEN" },
                    { text: "Îëê Î∞©ÏãùÏùÑ Îπ†Î•¥Í≤å ÌîÑÎ°úÌÜ†ÌÉÄÏù¥ÌïëÌï¥ÏÑú Ïã§Ï†ú ÏÑ±Îä•Í≥º Í≤∞Í≥ºÎ•º ÎπÑÍµê Í≤ÄÏ¶ùÌïúÎã§", type: "MOVE_FAST" },
                    { text: "Í∞Å Ï†ëÍ∑ºÎ≤ïÏùò Í∏∞Ïà†Ï†Å ÏõêÎ¶¨Î•º Î∂ÑÏÑùÌïòÍ≥†, Ïû•Í∏∞Ï†Å Ïú†ÏßÄÎ≥¥ÏàòÏÑ±Í≥º ÌôïÏû•ÏÑ±ÏùÑ Í≥†Î†§ÌïòÏó¨ ÏµúÏ†ÅÏùò ÏÜîÎ£®ÏÖòÏùÑ Ï∞æÎäîÎã§", type: "DEEP_ROOTS" }
                ]
            },
            {
                id: 4,
                question: "Ïú†ÏßÄÎ≥¥ÏàòÍ∞Ä Ïñ¥Î†§Ïö¥ Î†àÍ±∞Ïãú ÏΩîÎìúÎÇò ÎπÑÌö®Ïú®Ï†ÅÏù∏ Í∞úÎ∞ú ÌîÑÎ°úÏÑ∏Ïä§Î•º Î∞úÍ≤¨ÌñàÏùÑ Îïå ÎãπÏã†Ïùò ÌñâÎèôÏùÄ?",
                options: [
                    { text: "ÏûëÏùÄ Îã®ÏúÑÎ∂ÄÌÑ∞ Ï†êÏßÑÏ†ÅÏúºÎ°ú Í∞úÏÑ†ÏùÑ ÏãúÏûëÌïòÍ≥†, Îπ†Î•∏ Î∞òÎ≥µÏùÑ ÌÜµÌï¥ Ìö®Í≥ºÎ•º Í≤ÄÏ¶ùÌïòÎ©∞ Î≤îÏúÑÎ•º ÌôïÎåÄÌïúÎã§", type: "MOVE_FAST" },
                    { text: "ÌåÄÏõêÎì§Í≥º ÏùºÏÉÅÏ†ÅÏù∏ ÎåÄÌôîÎ•º ÌÜµÌï¥ Í∞ÅÏûêÍ∞Ä Í≤™Í≥† ÏûàÎäî Î¨∏Ï†úÎì§ÏùÑ Í≥µÏú†ÌïòÍ≥†, Ìï®Íªò Í∞úÏÑ† Î∞©ÏïàÏùÑ Í≥†ÎØºÌïúÎã§", type: "SMALL_TALK" },
                    { text: "Î¨∏Ï†úÏùò Í∑ºÎ≥∏ ÏõêÏù∏ÏùÑ Ï≤†Ï†ÄÌûà Î∂ÑÏÑùÌïòÍ≥†, ÏãúÏä§ÌÖú Ï†ÑÏ≤¥Ïùò ÏïÑÌÇ§ÌÖçÏ≤òÎ•º Í≥†Î†§Ìïú Ï≤¥Í≥ÑÏ†ÅÏù∏ Î¶¨Ìå©ÌÜ†ÎßÅ Í≥ÑÌöçÏùÑ ÏàòÎ¶ΩÌïúÎã§", type: "DEEP_ROOTS" },
                    { text: "Ïù¥ Î¨∏Ï†úÍ∞Ä Í≥†Í∞ùÏóêÍ≤å ÎØ∏ÏπòÎäî ÏòÅÌñ•(ÏÑ±Îä• Ï†ÄÌïò, Î≤ÑÍ∑∏ Î∞úÏÉù Í∞ÄÎä•ÏÑ± Îì±)ÏùÑ ÌèâÍ∞ÄÌïòÍ≥†, ÏÇ¨Ïö©Ïûê Í∞ÄÏπò Í∞úÏÑ† Í¥ÄÏ†êÏóêÏÑú Ïö∞ÏÑ†ÏàúÏúÑÎ•º Ï†ïÌïúÎã§", type: "CUSTOMER_DRIVEN" }
                ]
            },
            {
                id: 5,
                question: "Í∞ëÏûêÍ∏∞ ÏÑúÎπÑÏä§Ïóê ÏπòÎ™ÖÏ†ÅÏù∏ Ïû•Ïï†Í∞Ä Î∞úÏÉùÌñàÎã§Îäî ÏïåÎ¶ºÏùÑ Î∞õÏïòÏäµÎãàÎã§. ÎãπÏã†Ïùò Ï≤´ Î∞òÏùëÏùÄ?",
                options: [
                    { text: "Ïû•Ïï† ÎåÄÏùë Ï±ÑÎÑêÏóêÏÑú ÌåÄÏõêÎì§Í≥º Ïã§ÏãúÍ∞Ñ ÏÜåÌÜµÌïòÎ©∞ Í∞ÅÏûê ÌôïÏù∏Ìïú Ï†ïÎ≥¥Î•º Îπ†Î•¥Í≤å Ï∑®Ìï©ÌïòÏó¨ Ìï¥Í≤∞ÌïúÎã§", type: "SMALL_TALK" },
                    { text: "ÏòÅÌñ•Î∞õÎäî Í≥†Í∞ù ÏàòÏôÄ Í∏∞Îä•ÏùÑ ÌååÏïÖÌïòÍ≥†, Í≥†Í∞ù Í≥µÏßÄÏôÄ Ìï®Íªò ÏÑúÎπÑÏä§ Î≥µÍµ¨Î•º ÏµúÏö∞ÏÑ†ÏúºÎ°ú ÎåÄÏùëÌïúÎã§", type: "CUSTOMER_DRIVEN" },
                    { text: "Î™®ÎãàÌÑ∞ÎßÅ ÎèÑÍµ¨ÏôÄ Î°úÍ∑∏Î•º Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Î∂ÑÏÑùÌïòÏó¨ Ïû•Ïï†Ïùò Í∑ºÎ≥∏ ÏõêÏù∏ÏùÑ Ï†ïÌôïÌûà ÌååÏïÖÌïú ÌõÑ Ìï¥Í≤∞ÌïúÎã§", type: "DEEP_ROOTS" },
                    { text: "Ïö∞ÏÑ† ÏÑúÎπÑÏä§Î•º Îπ†Î•¥Í≤å Î≥µÍµ¨ÌïòÍ≥†, Ïù¥ÌõÑ Ïû¨Î∞ú Î∞©ÏßÄÎ•º ÏúÑÌïú Í∞úÏÑ†ÏÇ¨Ìï≠ÏùÑ Ïã†ÏÜçÌïòÍ≤å Ï†ÅÏö©ÌïúÎã§", type: "MOVE_FAST" }
                ]
            },
            {
                id: 6,
                question: "Í∞úÎ∞ú Ï§ë Í∞ëÏûêÍ∏∞ ÏÇ¨Ïö©Ïûê Í≤ΩÌóòÏùÑ Í∞úÏÑ†Ìï† Ïàò ÏûàÎäî Ï¢ãÏùÄ ÏïÑÏù¥ÎîîÏñ¥Í∞Ä Îñ†Ïò¨ÎûêÏäµÎãàÎã§. ÎãπÏã†Ïùò Îã§Ïùå ÌñâÎèôÏùÄ?",
                options: [
                    { text: "ÏïÑÏù¥ÎîîÏñ¥Ïùò Í∏∞Ïà†Ï†Å ÌÉÄÎãπÏÑ±Í≥º Í∏∞Ï°¥ ÏãúÏä§ÌÖúÍ≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ Í≤ÄÌÜ†Ìïú ÌõÑ Î™ÖÌôïÌïú Íµ¨ÌòÑ Í≥ÑÌöçÏùÑ ÏàòÎ¶ΩÌïúÎã§", type: "DEEP_ROOTS" },
                    { text: "Ïã§Ï†ú Ïú†Ï†ÄÍ∞Ä Í≤™Í≥† ÏûàÎäî Î¨∏Ï†úÏ†êÍ≥º Ïó∞Í≤∞ÌïòÏó¨ ÏïÑÏù¥ÎîîÏñ¥Ïùò Í∞ÄÏπòÎ•º Í≤ÄÏ¶ùÌïòÍ≥† Ïú†Ï†Ä Í¥ÄÏ†êÏóêÏÑú Íµ¨Ï≤¥ÌôîÌïúÎã§", type: "CUSTOMER_DRIVEN" },
                    { text: "Ï¶âÏãú Í∞ÑÎã®Ìïú ÌîÑÎ°úÌÜ†ÌÉÄÏûÖÏùÑ ÎßåÎì§Ïñ¥ Îπ†Î•¥Í≤å Í≤ÄÏ¶ùÌïòÍ≥† Í≤∞Í≥ºÏóê Îî∞Îùº Í∞úÏÑ†ÌïòÍ±∞ÎÇò Î∞©Ìñ•ÏùÑ Ï°∞Ï†ïÌïúÎã§", type: "MOVE_FAST" },
                    { text: "ÌåÄÏ±óÏóêÏÑú ÎèôÎ£åÎì§ÏóêÍ≤å ÏïÑÏù¥ÎîîÏñ¥Î•º Í∞ÑÎã®Ìûà Í≥µÏú†ÌïòÍ≥†, ÌîºÎìúÎ∞±ÏùÑ Î∞õÏïÑ Ìï®Íªò Î∞úÏ†ÑÏãúÌÇ®Îã§", type: "SMALL_TALK" }
                ]
            },
            {
                id: 7,
                question: "ÏïÑÎûò ÏÉÅÌô© Ï§ë, Í∞úÎ∞úÏûêÎ°úÏÑú ÏÜåÏÜåÌïòÏßÄÎßå ÌôïÏã§Ìïú Î≥¥ÎûåÏùÑ ÎäêÎÇÑ ÎïåÎäî Ïñ∏Ï†úÏù∏Í∞ÄÏöî?",
                options: [
                    { text: "ÎèôÎ£åÏôÄÏùò ÏùºÏÉÅ ÎåÄÌôîÏóêÏÑú ÎÇòÏò® ÏûëÏùÄ ÏïÑÏù¥ÎîîÏñ¥Í∞Ä Ïã§Ï†ú Í∞úÏÑ†ÏúºÎ°ú Ïù¥Ïñ¥Ïßà Îïå", type: "SMALL_TALK" },
                    { text: "ÏÉàÎ°úÏö¥ Í∏∞Ïà†ÏùÑ Îπ†Î•¥Í≤å ÌïôÏäµÌï¥ÏÑú ÌîÑÎ°úÏ†ùÌä∏Ïóê ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÅÏö©ÌñàÏùÑ Îïå", type: "MOVE_FAST" },
                    { text: "Í≥†Í∞ùÏóêÍ≤åÏÑú ÌîºÏ≥êÏóê ÎåÄÌïú Í∏çÏ†ïÏ†ÅÏù∏ ÌîºÎìúÎ∞±ÏùÑ Î∞õÏùÑ Îïå", type: "CUSTOMER_DRIVEN" },
                    { text: "Î≥µÏû°ÌñàÎçò ÏΩîÎìúÎ•º ÍπîÎÅîÌïòÍ≤å Î¶¨Ìå©ÌÜ†ÎßÅÌï¥ÏÑú ÌåÄÏõêÎì§Ïù¥ 'Ïù¥Ìï¥ÌïòÍ∏∞ Ïâ¨ÏõåÏ°åÎã§'Í≥† ÎßêÌï† Îïå", type: "DEEP_ROOTS" }
                ]
            }
        ];

        // ÏóÖÎ¨¥ ÏÑ±Ìñ•Î≥Ñ Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞
        const personalityTypes = {
            "CUSTOMER_DRIVEN": {
                name: "Customer Driven",
                title: "Keeper of the Key",
                description: "ÎãπÏã†ÏùÄ Ìï≠ÏÉÅ Í≥†Í∞ùÏùò Í¥ÄÏ†êÏóêÏÑú ÏÉùÍ∞ÅÌïòÍ≥† ÌñâÎèôÌïòÎäî Í∞úÎ∞úÏûêÏûÖÎãàÎã§. ÏÇ¨Ïö©Ïûê Í≤ΩÌóòÍ≥º Í≥†Í∞ù Í∞ÄÏπòÎ•º ÏµúÏö∞ÏÑ†ÏúºÎ°ú Í≥†Î†§ÌïòÎ©∞, Í∏∞Ïà†Ï†Å Í≤∞Ï†ïÏùÑ ÎÇ¥Î¶¥ ÎïåÎèÑ 'Ïù¥Í≤ÉÏù¥ Í≥†Í∞ùÏóêÍ≤å Ïñ¥Îñ§ ÎèÑÏõÄÏù¥ Îê†Íπå?'Î•º Î®ºÏ†Ä ÏÉùÍ∞ÅÌï©ÎãàÎã§.",
            },
            "DEEP_ROOTS": {
                name: "Deep Roots,<br>Clear Solutions",
                title: "North Star Architect",
                description: "ÎãπÏã†ÏùÄ ÍπäÏùÄ Î∞îÎã§Î•º Ïú†ÏòÅÌïòÎäî Í≥†ÎûòÏ≤òÎüº Í∑ºÎ≥∏ÏùÑ ÌÉêÍµ¨ÌïòÎäî ÌòÑÏûêÏûÖÎãàÎã§. Î∂ÅÍ∑πÏÑ±Ïù¥ Ìï≠Ìï¥ÏûêÎ•º Ïù¥ÎÅåÎìØ, Î≥µÏû°Ìïú Î¨∏Ï†ú ÏÜçÏóêÏÑúÎèÑ Î™ÖÌôïÌïú Ìï¥ÎãµÏùÑ Ï†úÏãúÌïòÎäî ÏóîÏßÄÎãàÏñ¥ÏûÖÎãàÎã§. ÌÉÑÌÉÑÌïú Í∏∞Ï¥à ÏúÑÏóê Îã®ÏàúÌïòÍ≥† Ïö∞ÏïÑÌïú ÏÜîÎ£®ÏÖòÏùÑ Íµ¨Ï∂ïÌïòÎ©∞, ÎãπÏã†Ïùò ÏΩîÎìúÎäî ÏãúÍ∞ÑÏù¥ ÏßÄÎÇòÎèÑ Î≥ÄÌïòÏßÄ ÏïäÎäî Í∞ÄÏπòÎ•º ÏßÄÎãôÎãàÎã§.",
            },
            "SMALL_TALK": {
                name: "Small Talk, Big Results",
                title: "Pack Communicator",
                description: "ÎãπÏã†ÏùÄ Î¨¥Î¶¨Î•º Ïù¥ÎÅÑÎäî ÎäëÎåÄÏ≤òÎüº ÏÜåÌÜµÏúºÎ°ú ÏãúÎÑàÏßÄÎ•º ÎßåÎìúÎäî Ïó∞Í≤∞ÏûêÏûÖÎãàÎã§. ÏûëÏùÄ Ïö∏Ïùå ÌïòÎÇòÎ°úÎèÑ Î¨¥Î¶¨ Ï†ÑÏ≤¥Î•º ÏõÄÏßÅÏù¥ÎìØ, ÏùºÏÉÅÏùò Í∞ÄÎ≤ºÏö¥ ÎåÄÌôîÏóêÏÑú ÌÅ∞ Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º Î∞úÍ≤¨ÌïòÎäî ÏóîÏßÄÎãàÏñ¥ÏûÖÎãàÎã§. ÎÅäÏûÑÏóÜÏù¥ ÏÉùÍ∞ÅÌïòÍ≥† ÏÜåÌÜµÌïòÎ©∞, ÎãπÏã†Ïùò ÌòëÏóÖÏùÄ ÏòàÏÉÅÏùÑ Îõ∞Ïñ¥ÎÑòÎäî ÎÜÄÎùºÏö¥ Í≤∞Í≥ºÎ•º ÎßåÎì§Ïñ¥ÎÉÖÎãàÎã§.",
            },
            "MOVE_FAST": {
                name: "Move Fast &<br>Adapt Quickly",
                title: "Speed Innovator",
                description: "ÎãπÏã†ÏùÄ ÏàúÍ∞ÑÏùò Ìè≠Î∞úÎ†•ÏúºÎ°ú Í≤∞Í≥ºÎ•º ÎßåÎìúÎäî ÏπòÌÉÄ Í∞ôÏùÄ Ïã§ÌñâÏûêÏûÖÎãàÎã§. Îπ†Î•∏ Ïã§ÌñâÍ≥º ÌïôÏäµÏúºÎ°ú Î™©ÌëúÎ•º Îã¨ÏÑ±ÌïòÎäî ÏóîÏßÄÎãàÏñ¥ÏûÖÎãàÎã§. Î≥ÄÌôîÌïòÎäî ÌôòÍ≤ΩÏóê Ï¶âÍ∞Å Ï†ÅÏùëÌïòÎ©∞, ÎãπÏã†Ïùò ÎØºÏ≤©Ìï®ÏùÄ ÌåÄÍ≥º Ï°∞ÏßÅÏùò Í≤ΩÏüÅÎ†•ÏùÑ Ìïú Îã®Í≥Ñ ÎÅåÏñ¥Ïò¨Î¶ΩÎãàÎã§.",
            }
        };

        let currentQuestionIndex = 0;
        let answers = {};
        let userNickname = "ÎãπÏã†";
        let currentPersonalityType = "CUSTOMER_DRIVEN";

        // Í≤∞Í≥º ÌÉÄÏûÖÎ≥Ñ ÎπÑÎîîÏò§ Îß§Ìïë
        const resultVideos = {
            'CUSTOMER_DRIVEN': 'test-result/customerdriven.mp4',
            'DEEP_ROOTS': 'test-result/deeprootsClearsolution.mp4',
            'SMALL_TALK': 'test-result/smalltalkBigresults.mp4',
            'MOVE_FAST': 'test-result/movefastAdaptquickly.mp4'
        };

        // Í≤∞Í≥º ÌÉÄÏûÖÎ≥Ñ Îã§Ïö¥Î°úÎìú Ïù¥ÎØ∏ÏßÄ Îß§Ìïë
        const resultDownloadImages = {
            'CUSTOMER_DRIVEN': 'test-result/imgdownload/customerdriven.png',
            'DEEP_ROOTS': 'test-result/imgdownload/deeprootsClearsolution.png',
            'SMALL_TALK': 'test-result/imgdownload/smalltalkBigresults.png',
            'MOVE_FAST': 'test-result/imgdownload/movefastAdaptquickly.png'
        };

        // Firebase Î¶¨ÎçîÎ≥¥Îìú Í¥ÄÎ†® Ìï®ÏàòÎì§
        async function saveResult(nickname, result) {
            console.log('saveResult Ìï®Ïàò Ìò∏Ï∂úÎê®:', nickname, result);
            // "test"Î°ú ÏãúÏûëÌïòÎäî ÎãâÎÑ§ÏûÑÏùÄ Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùå
            if (nickname.toLowerCase().startsWith('test')) {
                console.log('test Ï†ëÎëêÏÇ¨ ÎãâÎÑ§ÏûÑÏúºÎ°ú Ï†ÄÏû• ÏïàÌï®');
                return;
            }
            
            try {
                // Firebase Ïó∞Í≤∞ ÌôïÏù∏
                if (!window.firebaseDB || !window.firebaseCollections) {
                    console.log('Firebase Ïó∞Í≤∞ ÏóÜÏùå, Î°úÏª¨ Ï†ÄÏû•ÏúºÎ°ú ÎåÄÏ≤¥');
                    saveResultLocal(nickname, result);
                    return;
                }
                
                const { collection, addDoc } = window.firebaseCollections;
                const entry = {
                    nickname: nickname,
                    result: result,
                    timestamp: new Date()
                };
                
                await addDoc(collection(window.firebaseDB, 'leaderboard'), entry);
                console.log('Í≤∞Í≥ºÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
            } catch (error) {
                console.error('Í≤∞Í≥º Ï†ÄÏû• Ï§ë Ïò§Î•ò:', error);
                // Firebase Ïã§Ìå® Ïãú Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÎ°ú Ìè¥Î∞±
                saveResultLocal(nickname, result);
            }
        }

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ Ìè¥Î∞± Ìï®Ïàò
        function saveResultLocal(nickname, result) {
            let leaderboard = JSON.parse(localStorage.getItem('mbtiLeaderboard') || '[]');
            const entry = {
                nickname: nickname,
                result: result,
                timestamp: new Date().toISOString()
            };
            leaderboard.push(entry);
            if (leaderboard.length > 50) {
                leaderboard = leaderboard.slice(-50);
            }
            localStorage.setItem('mbtiLeaderboard', JSON.stringify(leaderboard));
        }

        async function getLeaderboard() {
            try {
                // Firebase Ïó∞Í≤∞ ÌôïÏù∏
                if (!window.firebaseDB || !window.firebaseCollections) {
                    console.log('Firebase Ïó∞Í≤∞ ÏóÜÏùå, Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ ÏÇ¨Ïö©');
                    return JSON.parse(localStorage.getItem('mbtiLeaderboard') || '[]');
                }
                
                const { collection, getDocs, query, orderBy, limit } = window.firebaseCollections;
                const q = query(
                    collection(window.firebaseDB, 'leaderboard'), 
                    orderBy('timestamp', 'desc'), 
                    limit(20)
                );
                const querySnapshot = await getDocs(q);
                const leaderboard = [];
                querySnapshot.forEach((doc) => {
                    leaderboard.push(doc.data());
                });
                console.log('FirebaseÏóêÏÑú Î¶¨ÎçîÎ≥¥Îìú Î°úÎìú ÏÑ±Í≥µ:', leaderboard.length, 'Í∞ú Ìï≠Î™©');
                return leaderboard;
            } catch (error) {
                console.error('Î¶¨ÎçîÎ≥¥Îìú Î°úÎìú Ï§ë Ïò§Î•ò:', error);
                // Firebase Ïã§Ìå® Ïãú Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÎ°ú Ìè¥Î∞±
                return JSON.parse(localStorage.getItem('mbtiLeaderboard') || '[]');
            }
        }

        async function displayLeaderboard() {
            console.log('displayLeaderboard Ìï®Ïàò Ìò∏Ï∂úÎê®');
            
            let leaderboard = [];
            
            try {
                leaderboard = await getLeaderboard();
                console.log('Î¶¨ÎçîÎ≥¥Îìú Îç∞Ïù¥ÌÑ∞:', leaderboard);
                console.log('Î¶¨ÎçîÎ≥¥Îìú Ìï≠Î™© Ïàò:', leaderboard.length);
            } catch (error) {
                console.error('Î¶¨ÎçîÎ≥¥Îìú Î°úÎìú Ïò§Î•ò:', error);
                leaderboard = JSON.parse(localStorage.getItem('mbtiLeaderboard') || '[]');
                console.log('Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ Ìè¥Î∞± Îç∞Ïù¥ÌÑ∞:', leaderboard);
            }
            
            let leaderboardHTML = '';
            
            if (leaderboard.length === 0) {
                leaderboardHTML = '<div class="leaderboard-empty">ÏïÑÏßÅ Í≤∞Í≥ºÍ∞Ä ÏóÜÏñ¥Ïöî ü§î</div>';
            } else {
                leaderboardHTML = leaderboard
                    .slice(0, 10) // ÏµúÍ∑º 10Í∞úÎßå ÌëúÏãú
                    .map(entry => `
                        <div class="leaderboard-item">
                            <div class="leaderboard-nickname">${entry.nickname}</div>
                            <div class="leaderboard-result">${entry.result}</div>
                        </div>
                    `).join('');
            }
            
            return `
                <div class="leaderboard">
                    <h3>Îã§Î•∏ ÏÇ¨ÎûåÏùò Í≤∞Í≥ºÎäî Ïñ¥Îñ®Íπå?</h3>
                    <div class="leaderboard-list">
                        ${leaderboardHTML}
                    </div>
                </div>
            `;
        }

        // Î∞∞Ïó¥ ÏÖîÌîå Ìï®Ïàò
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startTest() {
            // ÎãâÎÑ§ÏûÑ Ï†ÄÏû•
            const nicknameInput = document.getElementById('nicknameInput');
            const nickname = nicknameInput.value.trim();
            
            if (nickname) {
                userNickname = nickname;
            } else {
                alert('ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            showQuestion(0);
        }

        function showQuestion(index) {
            const question = questions[index];
            const questionElement = document.getElementById('currentQuestion');
            
            // ÏÑ†ÌÉùÏßÄ ÏàúÏÑúÎ•º ÎûúÎç§ÏúºÎ°ú ÏÑûÍ∏∞
            const shuffledOptions = shuffleArray(question.options);
            
            // ÏßàÎ¨∏Í≥º ÏÑ†ÌÉùÏßÄÏóêÏÑú "ÎãπÏã†" ÎåÄÏã† ÎãâÎÑ§ÏûÑ ÏÇ¨Ïö©
            const personalizedQuestion = question.question.replace(/ÎãπÏã†/g, userNickname);
            const personalizedOptions = shuffledOptions.map(option => ({
                ...option,
                text: option.text.replace(/ÎãπÏã†/g, userNickname)
            }));
            
            questionElement.innerHTML = `
                <div class="question-header">
                    <div class="question-number">Q${index + 1}</div>
                    <h3 class="question-text">${personalizedQuestion}</h3>
                </div>
                <div class="options">
                    ${personalizedOptions.map((option, i) => `
                        <div class="option" onclick="selectOption(${index}, '${option.type}')">
                            <input type="radio" name="q${index}" value="${option.type}" id="q${index}_${i}">
                            <div class="option-text">${option.text}</div>
                        </div>
                    `).join('')}
                </div>
            `;

            updateProgress();
        }

        function selectOption(questionIndex, type) {
            // Ïù¥Ï†Ñ ÏÑ†ÌÉù Ìï¥Ï†ú
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // ÌòÑÏû¨ ÏÑ†ÌÉù ÌëúÏãú
            event.currentTarget.classList.add('selected');
            event.currentTarget.querySelector('input').checked = true;
            
            // ÎãµÎ≥Ä Ï†ÄÏû•
            answers[questionIndex] = type;
            
            // Ïû†Ïãú ÎåÄÍ∏∞ ÌõÑ Îã§Ïùå ÏßàÎ¨∏ÏúºÎ°ú Ïù¥Îèô
            setTimeout(async () => {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                } else {
                    await showResult(null, true);
                }
            }, 500);
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
                document.getElementById('nextBtn').disabled = true;
            } else {
                showResult(null, true);
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
                if (answers[currentQuestionIndex] !== undefined) {
                    document.getElementById('nextBtn').disabled = false;
                }
            }
        }

        function updateProgress() {
            const segments = document.querySelectorAll('.progress-segment');
            segments.forEach((segment, index) => {
                if (index <= currentQuestionIndex) {
                    segment.classList.add('active');
                } else {
                    segment.classList.remove('active');
                }
            });
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentQuestionIndex > 0 ? 'block' : 'none';
            nextBtn.textContent = currentQuestionIndex === questions.length - 1 ? 'Í≤∞Í≥º Î≥¥Í∏∞' : 'Îã§Ïùå';
            
            // Ïù¥ÎØ∏ ÎãµÎ≥ÄÌïú ÏßàÎ¨∏Ïù∏ÏßÄ ÌôïÏù∏
            if (answers[currentQuestionIndex] !== undefined) {
                nextBtn.disabled = false;
                // ÏÑ†ÌÉùÎêú ÏòµÏÖò ÌëúÏãú
                setTimeout(() => {
                    const selectedType = answers[currentQuestionIndex];
                    const selectedOption = document.querySelector(`input[value="${selectedType}"]`);
                    if (selectedOption) {
                        selectedOption.closest('.option').classList.add('selected');
                        selectedOption.checked = true;
                    }
                }, 100);
            }
        }

        function calculatePersonalityType() {
            const typeScores = { 
                CUSTOMER_DRIVEN: 0, 
                DEEP_ROOTS: 0, 
                SMALL_TALK: 0, 
                MOVE_FAST: 0 
            };
            
            Object.values(answers).forEach(type => {
                typeScores[type]++;
            });
            
            // Í∞ÄÏû• ÎÜíÏùÄ Ï†êÏàòÎ•º Î∞õÏùÄ Ïú†Ìòï Ï∞æÍ∏∞
            let maxScore = 0;
            let resultType = 'CUSTOMER_DRIVEN';
            
            for (const [type, score] of Object.entries(typeScores)) {
                if (score > maxScore) {
                    maxScore = score;
                    resultType = type;
                }
            }
                
            return resultType;
        }

        async function showResult(selectedType = null, isInitialResult = false) {
            console.log('showResult Ìï®Ïàò Ìò∏Ï∂úÎê®');
            const personalityType = selectedType || calculatePersonalityType();
            currentPersonalityType = personalityType; // ÌòÑÏû¨ ÏÑ±Í≤© ÌÉÄÏûÖ Ï†ÄÏû•
            console.log('personalityType:', personalityType);
            const result = personalityTypes[personalityType];
            console.log('result:', result);
            
            // ÏµúÏ¥à ÌÖåÏä§Ìä∏ Í≤∞Í≥ºÍ∞Ä ÏïÑÎãå Í≤ΩÏö∞ (Îã§Î•∏ Í≤∞Í≥ºÎ°ú Ï†ÑÌôòÌïú Í≤ΩÏö∞)
            if (selectedType && !isInitialResult) {
                console.log('Îã§Î•∏ Í≤∞Í≥ºÎ°ú Ï†ÑÌôò - Î¶¨ÎçîÎ≥¥ÎìúÏóê Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùå');
            }
            
            document.getElementById('questionContainer').style.display = 'none';
            
            // Îã§Î•∏ 3Í∞ú ÏÑ±Ìñ• Í∞ÄÏ†∏Ïò§Í∏∞
            const otherTypes = Object.keys(personalityTypes).filter(type => type !== personalityType);
            
            // Í≤∞Í≥º ÏÑ§Î™ÖÏóêÏÑúÎèÑ "ÎãπÏã†" ÎåÄÏã† ÎãâÎÑ§ÏûÑ ÏÇ¨Ïö©
            const personalizedDescription = result.description.replace(/ÎãπÏã†/g, userNickname);

            const resultContainer = document.getElementById('resultContainer');
            const resultVideo = resultVideos[personalityType] || 'test-result/customerdriven.mp4';
            
            resultContainer.innerHTML = `
                <div class="result-card" id="resultCard">
                    <div class="result-type">
                        <video src="${resultVideo}" autoplay loop muted playsinline preload="auto">
                            <source src="${resultVideo}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    
                    <div class="result-description">
                        <h3>${result.name}</h3>
                        <h4>${result.title}</h4>
                        <p>${personalizedDescription}</p>
                    </div>
                </div>

                <div class="other-results">
                    <h3>Îã§Î•∏ ÏóÖÎ¨¥ ÏÑ±Ìñ•Îì§ÎèÑ Í∂ÅÍ∏àÌïòÎã§Î©¥?</h3>
                    <div class="other-cards">
                        ${otherTypes.map(type => {
                            const otherResult = personalityTypes[type];
                            return `
                                <div class="other-card" onclick="showResultAsync('${type}')">
                                    <h4>${otherResult.name}</h4>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="download-btn" onclick="downloadResultImage()" id="downloadBtn">
                        Í≤∞Í≥º Ïù¥ÎØ∏ÏßÄ Îã§Ïö¥Î°úÎìú
                    </button>
                    <button class="btn" onclick="restartTest()">
                        Îã§Ïãú ÌÖåÏä§Ìä∏ÌïòÍ∏∞
                    </button>
                </div>
                
                ${await displayLeaderboard()}
            `;
            
            // Í≤∞Í≥º Ï†ÄÏû• (ÏµúÏ¥à ÌÖåÏä§Ìä∏ Í≤∞Í≥ºÎßå)
            if (!selectedType || isInitialResult) {
                await saveResult(userNickname, result.name);
                console.log('Î¶¨ÎçîÎ≥¥ÎìúÏóê Ï†ÄÏû•Îê®');
            } else {
                console.log('Îã§Î•∏ Í≤∞Í≥ºÎ°ú Ï†ÑÌôò - Î¶¨ÎçîÎ≥¥ÎìúÏóê Ï†ÄÏû•ÎêòÏßÄ ÏïäÏùå');
            }
            
            console.log('resultContainer ÌëúÏãú ÏãúÏûë');
            console.log('resultContainer element:', resultContainer);
            
            // Í≤∞Í≥º ÌéòÏù¥ÏßÄÏóêÏÑú test-container Ïπ¥Îìú Ïä§ÌÉÄÏùº Ï†úÍ±∞
            const testContainer = document.querySelector('.test-container');
            testContainer.style.background = 'transparent';
            testContainer.style.boxShadow = 'none';
            testContainer.style.borderRadius = '0';
            testContainer.style.padding = '0';
            
            resultContainer.style.display = 'block';
            console.log('resultContainer display ÏÑ§Ï†ï ÏôÑÎ£å');
            
            // ÌéòÏù¥ÏßÄ ÏÉÅÎã®ÏúºÎ°ú Ïä§ÌÅ¨Î°§
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Ïù∏ÌÑ∞Î†âÌã∞Î∏å ÌöåÏ†Ñ Ìö®Í≥º Ï¥àÍ∏∞Ìôî
            setTimeout(() => {
                initInteractiveRotation();
            }, 100);
        }

        // other-card ÌÅ¥Î¶≠Ïö© async wrapper Ìï®Ïàò
        async function showResultAsync(selectedType) {
            await showResult(selectedType);
        }

        function restartTest() {
            currentQuestionIndex = 0;
            answers = {};
            userNickname = "ÎãπÏã†";
            currentPersonalityType = "CUSTOMER_DRIVEN";
            
            // ÎãâÎÑ§ÏûÑ ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
            document.getElementById('nicknameInput').value = '';
            
            // ÌéòÏù¥ÏßÄ ÏÉÅÎã®ÏúºÎ°ú Ïä§ÌÅ¨Î°§
            window.scrollTo({ top: 0, behavior: 'instant' });
            
            // ÌôîÎ©¥ Ï†ÑÌôòÏùÑ Î®ºÏ†Ä Ïã§Ìñâ
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';  // flexÎ°ú ÏÑ§Ï†ïÌï¥ÏÑú Ï§ëÏïôÏ†ïÎ†¨ ÌôïÏã§Ìûà
            
            // Ïû†Ïãú ÌõÑ test-container Ïä§ÌÉÄÏùº Î≥µÏõê (ÌôîÎ©¥ Ï†ÑÌôò ÌõÑÏóê)
            setTimeout(() => {
                const testContainer = document.querySelector('.test-container');
                testContainer.style.background = 'white';
                testContainer.style.boxShadow = '0 20px 40px rgba(0,0,0,0.1)';
                testContainer.style.borderRadius = '20px';
                testContainer.style.padding = '70px 50px';
                testContainer.style.marginBottom = '40px';
            }, 50);
        }

        // ÎßàÏö∞Ïä§ ÏúÑÏπòÏóê Îî∞Î•∏ Ïù∏ÌÑ∞Î†âÌã∞Î∏å ÌöåÏ†Ñ Ìö®Í≥º
        function initInteractiveRotation() {
            const resultVideo = document.querySelector('.result-type video');
            if (!resultVideo) return;

            resultVideo.addEventListener('mousemove', (e) => {
                const rect = resultVideo.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                const mouseX = e.clientX - centerX;
                const mouseY = e.clientY - centerY;
                
                // ÌöåÏ†Ñ Í∞ÅÎèÑ Í≥ÑÏÇ∞ (-12ÎèÑ ~ +12ÎèÑ)
                const rotateY = (mouseX / (rect.width / 2)) * 12;
                const rotateX = -(mouseY / (rect.height / 2)) * 12;
                
                resultVideo.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg) scale(1.015)`;
            });

            resultVideo.addEventListener('mouseleave', () => {
                resultVideo.style.transform = 'rotateY(0deg) rotateX(0deg) scale(1)';
            });
        }

        async function downloadResultImage() {
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = downloadBtn.innerHTML;
            
            try {
                // Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî Î∞è Î°úÎî© ÏÉÅÌÉú ÌëúÏãú
                downloadBtn.disabled = true;
                downloadBtn.innerHTML = 'Îã§Ïö¥Î°úÎìú Ï§ë...';
                
                // ÌòÑÏû¨ Í≤∞Í≥º ÌÉÄÏûÖÏùò Îã§Ïö¥Î°úÎìú Ïù¥ÎØ∏ÏßÄ URL Í∞ÄÏ†∏Ïò§Í∏∞
                const imageSrc = resultDownloadImages[currentPersonalityType] || 'test-result/imgdownload/customerdriven.png';
                console.log('Îã§Ïö¥Î°úÎìú Ïù¥ÎØ∏ÏßÄ ÏÜåÏä§:', imageSrc);
                
                // Í∞ÑÎã®Ìïú ÎßÅÌÅ¨ Îã§Ïö¥Î°úÎìú Î∞©Ïãù ÏÇ¨Ïö©
                const link = document.createElement('a');
                link.href = imageSrc;
                link.target = '_blank';
                
                // ÌååÏùºÎ™ÖÏóêÏÑú Í≤∞Í≥º ÌÉÄÏûÖ Ï∂îÏ∂ú
                const fileName = imageSrc.split('/').pop().split('.')[0];
                link.download = `${fileName}_${new Date().getFullYear()}${String(new Date().getMonth() + 1).padStart(2, '0')}${String(new Date().getDate()).padStart(2, '0')}.png`;
                
                // Îã§Ïö¥Î°úÎìú Ïã§Ìñâ
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // ÏÑ±Í≥µ Î©îÏãúÏßÄ
                downloadBtn.innerHTML = 'Îã§Ïö¥Î°úÎìú ÏôÑÎ£å!';
                setTimeout(() => {
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Ïù¥ÎØ∏ÏßÄ Îã§Ïö¥Î°úÎìú Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                
                // Ïò§Î•ò Î©îÏãúÏßÄ
                downloadBtn.innerHTML = 'Îã§Ïö¥Î°úÎìú Ïã§Ìå®';
                setTimeout(() => {
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                }, 2000);
                
                alert('Ïù¥ÎØ∏ÏßÄ Îã§Ïö¥Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
            }
        }
    </script>
</body>
</html> 